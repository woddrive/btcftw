<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bitcoin Real-time Ticker</title>
  <meta name="robots" content="noindex, nofollow">
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <link rel="stylesheet" href="style.css">
  <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="disk"><img src="bloomer.png"><br></div>
    <div class="ticker">
      <!-- Currency selector removed -->
      <span class="mybtc">$<span id="my-btc"></span></span>
      <p>Current Price: <span class="price" id="bitcoin-price">Loading...</span></p>
      <div id="countdown" class="countdown">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40">
          <circle cx="20" cy="20" r="18"></circle>
          <circle cx="20" cy="20" r="18"></circle>
        </svg>               
        <span class="countdown-text">30s</span>
      </div>
      <div id="bitcoin-chart"></div>
    </div>
  </div>
  <script>
    const bitcoinPriceElement = document.getElementById('bitcoin-price');
    const countdownElement = document.getElementById('countdown');
    const defaultCurrency = 'cad'; // Default currency set to CAD
    let remainingTime = 30;

    function updateBitcoinPrice() {
      fetch(`https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=${defaultCurrency}`)
        .then(response => response.json())
        .then(data => {
          const price = data.bitcoin[defaultCurrency];
          bitcoinPriceElement.textContent = `${price.toLocaleString(undefined, { minimumFractionDigits: 2 })} ${defaultCurrency.toUpperCase()}`;
          remainingTime = 30;
          fetchAndUpdateChartData(defaultCurrency); // Update chart with CAD
        })
        .catch(error => {
          console.error('Error fetching Bitcoin price:', error);
          bitcoinPriceElement.textContent = 'Error fetching price';
        });
    }
    function updateCountdown() {
      remainingTime--;
      const strokeDashoffset = (1 - (remainingTime / 30)) * 113.097;
      const countdownCircle = document.querySelector('#countdown circle:nth-child(2)');
      countdownCircle.style.strokeDashoffset = strokeDashoffset;

      const countdownText = document.querySelector('.countdown-text');
      countdownText.textContent = `${remainingTime}s`;

      if (remainingTime <= 0) {
        updateBitcoinPrice();
      }
    }
    setInterval(updateCountdown, 1000); // Update the countdown every second
    updateBitcoinPrice(); // Initial price update
  </script>
  <script>
    async function fetchAndUpdateChartData(currency) {
      try {
        const response = await fetch(`https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=${currency}&days=30&interval=daily`);
        const data = await response.json();
        createBitcoinChart(data, currency);
      } catch (error) {
        console.error('Error fetching chart data:', error);
      }
    }
  
    function createBitcoinChart(data, currency) {
      // Chart creation logic remains the same
    }

    fetchAndUpdateChartData(defaultCurrency); // Fetch and update chart with CAD initially
  </script>
  <script>
    const myBitcoinElement = document.getElementById('my-btc');

    function calculateBitcoinValue(amount, price, currency) {
      // Value calculation logic remains the same
    }

    function updateBitcoinValue(amount, currency) {
      fetch(`https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=${currency}`)
        .then(response => response.json())
        .then(data => {
          const price = data.bitcoin[currency];
          const calculatedValue = calculateBitcoinValue(amount, price, currency);
          myBitcoinElement.textContent = calculatedValue;
        })
        .catch(error => {
          console.error('Error fetching Bitcoin price:', error);
          myBitcoinElement.textContent = 'Error calculating value';
        });
    }

    function calculateBitcoinAmountValue() {
      fetch('bitcoinAmount.txt')
        .then(response => response.text())
        .then(data => {
          const amount = parseFloat(data.trim());
          updateBitcoinValue(amount, defaultCurrency); // Use CAD as the default currency
        })
        .catch(error => {
          console.error('Error fetching Bitcoin amount:', error);
        });
    }

    calculateBitcoinAmountValue();
  </script>
</body>
</html>
